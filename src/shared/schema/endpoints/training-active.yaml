# Schemas
schemas:
  # Схема для подхода
  TrainingSet:
    type: object
    required:
      - id
      - weight
      - repeatCount
    properties:
      id:
        type: integer
        example: 1
      weight:
        type: number
        minimum: 0
        maximum: 1000
        example: 103
      repeatCount:
        type: integer
        minimum: 1
        maximum: 100
        example: 10

  # Схема упражнения
  ExerciseType:
    type: object
    required:
      - id
      - name
      - favorite
      - muscleGroups
      - restTime
      - useCustomSets
      - completedSets
      - sets
    properties:
      id:
        type: string
        format: uuid
        example: "10"
      name:
        type: string
        example: "Скручивания на пресс"
      favorite:
        type: boolean
        example: false
      description:
        type: string
        example: "Упражнение на пресс"
      muscleGroups:
        type: array
        items:
          type: string
        example: ["strength", "abs"]
      restTime:
        type: integer
        minimum: 0
        maximum: 600
        description: "Время отдыха в секундах"
        example: 60
      useCustomSets:
        type: boolean
        default: false
        example: false
      completedSets:
        type: integer
        minimum: 0
        description: "Количество выполненных подходов"
        example: 3
      sets:
        type: array
        items:
          $ref: "#/schemas/TrainingSet"

  # Основная схема активной тренировки
  ActiveTraining:
    type: object
    required:
      - id
      - dateStart
      - exercises
    properties:
      id:
        type: string
        format: uuid
        example: "5922f4f1-7989-4e02-80b0-77ecee62a25b"
      dateStart:
        type: string
        format: date-time
        example: "2024-01-15T10:30:00Z"
      exercises:
        type: array
        items:
          $ref: "#/schemas/ExerciseType"

  # Для создания новой активной тренировки
  CreateActiveTraining:
    type: object
    required:
      - dateStart
      - exercises
    properties:
      dateStart:
        type: string
        format: date-time
      exercises:
        type: array
        items:
          $ref: "#/schemas/ExerciseType"

  # Для обновления активной тренировки
  UpdateActiveTraining:
    type: object
    properties:
      dateStart:
        type: string
        format: date-time
      exercises:
        type: array
        items:
          $ref: "#/schemas/ExerciseType"

  # Для ответа со списком активных тренировок
  ActiveTrainingsList:
    type: object
    required:
      - list
      - total
      - totalPages
    properties:
      list:
        type: array
        items:
          $ref: "#/schemas/ActiveTraining"
      total:
        type: integer
      totalPages:
        type: integer

  # Для старта тренировки
  StartTrainingRequest:
    type: object
    required:
      - trainingId
    properties:
      trainingId:
        type: string
        format: uuid

  # Для завершения тренировки
  CompleteTrainingRequest:
    type: object
    required:
      - completedSets
    properties:
      completedSets:
        type: integer
        minimum: 0
        description: "Количество выполненных подходов"
      notes:
        type: string

  # История тренировок (завершенные)
  TrainingHistory:
    type: object
    required:
      - id
      - dateStart
      - exercises
    properties:
      id:
        type: string
        format: uuid
      dateStart:
        type: string
        format: date-time
      exercises:
        type: array
        items:
          $ref: "#/schemas/ExerciseType"

# Endpoints

## Базовые CRUD операции для активных тренировок
getActiveTrainings:
  summary: Get all active trainings
  security:
    - bearerAuth: []
  parameters:
    - name: page
      in: query
      required: false
      schema:
        type: integer
        default: 1
    - name: limit
      in: query
      required: false
      schema:
        type: integer
        default: 10
    - name: startDate
      in: query
      required: false
      schema:
        type: string
        format: date
    - name: endDate
      in: query
      required: false
      schema:
        type: string
        format: date
  responses:
    "200":
      description: List of active trainings
      content:
        application/json:
          schema:
            $ref: "#/schemas/ActiveTrainingsList"
    "401":
      description: Unauthorized

createActiveTraining:
  summary: Create a new active training
  security:
    - bearerAuth: []
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: "#/schemas/CreateActiveTraining"
  responses:
    "201":
      description: Active training created successfully
      content:
        application/json:
          schema:
            $ref: "#/schemas/ActiveTraining"
    "400":
      description: Invalid input
    "401":
      description: Unauthorized

getActiveTrainingById:
  summary: Get active training by id
  security:
    - bearerAuth: []
  parameters:
    - name: trainingId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  responses:
    "200":
      description: Active training
      content:
        application/json:
          schema:
            $ref: "#/schemas/ActiveTraining"
    "401":
      description: Unauthorized
    "404":
      description: Active training not found

updateActiveTraining:
  summary: Update an active training
  security:
    - bearerAuth: []
  parameters:
    - name: trainingId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: "#/schemas/UpdateActiveTraining"
  responses:
    "200":
      description: Active training updated successfully
      content:
        application/json:
          schema:
            $ref: "#/schemas/ActiveTraining"
    "400":
      description: Invalid input
    "401":
      description: Unauthorized
    "404":
      description: Active training not found

deleteActiveTraining:
  summary: Delete an active training
  security:
    - bearerAuth: []
  parameters:
    - name: trainingId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  responses:
    "204":
      description: Active training deleted successfully
    "401":
      description: Unauthorized
    "404":
      description: Active training not found

## Операции с тренировочным процессом
startActiveTraining:
  summary: Start an active training session
  security:
    - bearerAuth: []
  parameters:
    - name: trainingId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  responses:
    "200":
      description: Training started successfully
      content:
        application/json:
          schema:
            $ref: "#/schemas/ActiveTraining"
    "401":
      description: Unauthorized
    "404":
      description: Training not found
    "409":
      description: Training already started

completeActiveTraining:
  summary: Complete an active training
  security:
    - bearerAuth: []
  parameters:
    - name: trainingId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: "#/schemas/CompleteTrainingRequest"
  responses:
    "200":
      description: Training completed successfully
      content:
        application/json:
          schema:
            $ref: "#/schemas/TrainingHistory"
    "400":
      description: Invalid input
    "401":
      description: Unauthorized
    "404":
      description: Training not found

cancelActiveTraining:
  summary: Cancel an active training
  security:
    - bearerAuth: []
  parameters:
    - name: trainingId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  responses:
    "200":
      description: Training cancelled successfully
      content:
        application/json:
          schema:
            $ref: "#/schemas/ActiveTraining"
    "401":
      description: Unauthorized
    "404":
      description: Training not found

## История тренировок
getTrainingHistory:
  summary: Get training history
  security:
    - bearerAuth: []
  parameters:
    - name: page
      in: query
      required: false
      schema:
        type: integer
        default: 1
    - name: limit
      in: query
      required: false
      schema:
        type: integer
        default: 10
    - name: startDate
      in: query
      required: false
      schema:
        type: string
        format: date
    - name: endDate
      in: query
      required: false
      schema:
        type: string
        format: date
  responses:
    "200":
      description: List of training history
      content:
        application/json:
          schema:
            type: object
            required:
              - list
              - total
              - totalPages
            properties:
              list:
                type: array
                items:
                  $ref: "#/schemas/TrainingHistory"
              total:
                type: integer
              totalPages:
                type: integer
    "401":
      description: Unauthorized
